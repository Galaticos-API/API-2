<?xml version="1.0" encoding="UTF-8"?>

<?import java.net.URL?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>

<ScrollPane fitToWidth="true" styleClass="root" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="gui.menu.DashboardController">
    <stylesheets>
        <URL value="@/css/StyleMain.css" /> </stylesheets>
    <content>
        <VBox alignment="TOP_CENTER" spacing="20.0">
            <padding>
                <Insets bottom="40.0" left="40.0" right="40.0" top="40.0" />
            </padding>
            <children>

                <BorderPane fx:id="filterContainer">
                    <left>
                        <Label fx:id="lblTitulo" styleClass="page-title" text="Dashboard de Desempenho" />
                    </left>
                    <right>
                        <HBox fx:id="filterBar" alignment="CENTER_RIGHT" spacing="10.0" styleClass="filter-bar">
                            <children>
                                <ComboBox fx:id="comboAno" prefWidth="120.0" promptText="Filtrar por Ano" />
                                <ComboBox fx:id="comboSetor" prefWidth="160.0" promptText="Filtrar por Setor" />
                                <ComboBox fx:id="comboGestor" prefWidth="160.0" promptText="Filtrar por Gestor" />
                                <Button fx:id="btnLimparFiltros" mnemonicParsing="false" text="Limpar" />
                            </children>
                        </HBox>
                    </right>
                </BorderPane>

                <GridPane fx:id="kpiGrid" hgap="25.0" vgap="25.0">
                    <columnConstraints>
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                    </columnConstraints>
                    <rowConstraints>
                        <RowConstraints minHeight="10.0" prefHeight="130.0" vgrow="SOMETIMES" />
                        <RowConstraints minHeight="10.0" prefHeight="130.0" vgrow="SOMETIMES" />
                    </rowConstraints>
                    <children>
                        <VBox fx:id="kpiBox1" alignment="CENTER_LEFT" spacing="10.0" styleClass="kpi-card" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <children>
                                <Label fx:id="kpiTitle1" styleClass="kpi-title" text="PDIs Ativos" />
                                <Label fx:id="lblTotalPdisAtivos" styleClass="kpi-value" text="0" />
                            </children>
                        </VBox>
                        <VBox fx:id="kpiBox2" alignment="CENTER_LEFT" spacing="10.0" styleClass="kpi-card" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <children>
                                <Label fx:id="kpiTitle2" styleClass="kpi-title" text="Usuários Ativos" />
                                <Label fx:id="lblUsuariosAtivos" styleClass="kpi-value" text="0" />
                            </children>
                        </VBox>
                        <VBox fx:id="kpiBox3" alignment="CENTER_LEFT" spacing="10.0" styleClass="kpi-card" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <children>
                                <Label fx:id="kpiTitle3" styleClass="kpi-title" text="Objetivos Pendentes" />
                                <Label fx:id="lblObjetivosPendentes" styleClass="kpi-value" text="0" />
                            </children>
                        </VBox>
                        <VBox fx:id="kpiBox4" alignment="CENTER_LEFT" spacing="10.0" styleClass="kpi-card" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <children>
                                <Label fx:id="kpiTitle4" styleClass="kpi-title" text="Média de Conclusão (Geral)" />
                                <Label fx:id="lblMediaConclusao" styleClass="kpi-value" text="0%" />
                            </children>
                        </VBox>
                        <VBox fx:id="kpiBox5" alignment="CENTER_LEFT" spacing="10.0" styleClass="kpi-card" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <children>
                                <Label fx:id="kpiTitle5" styleClass="kpi-title" text="Média de Objetivos/PDI" />
                                <Label fx:id="lblMediaObjetivosPDI" styleClass="kpi-value" text="0.0" />
                            </children>
                        </VBox>
                        <VBox fx:id="kpiBox6" alignment="CENTER_LEFT" spacing="10.0" styleClass="kpi-card" GridPane.columnIndex="2" GridPane.rowIndex="1">
                            <children>
                                <Label fx:id="kpiTitle6" styleClass="kpi-title" text="Taxa de Conclusão (Objetivos)" />
                                <Label fx:id="lblTaxaConclusaoObjetivos" styleClass="kpi-value" text="0%" />
                            </children>
                        </VBox>
                    </children>
                </GridPane>

                <GridPane fx:id="chartsGrid1" hgap="25.0" vgap="25.0">
                    <columnConstraints>
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                    </columnConstraints>
                    <rowConstraints>
                        <RowConstraints minHeight="10.0" prefHeight="300.0" vgrow="SOMETIMES" />
                    </rowConstraints>
                    <children>

                        <VBox fx:id="chartBoxPdisPorAno" styleClass="content-card" spacing="10.0" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <children>
                                <Label styleClass="widget-title" text="Histórico de PDIs Criados por Ano" />
                                <LineChart fx:id="lineChartPdisPorAno" VBox.vgrow="ALWAYS" legendVisible="false">
                                    <xAxis>
                                        <CategoryAxis side="BOTTOM" label="Ano" />
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis side="LEFT" label="Quantidade" />
                                    </yAxis>
                                </LineChart>
                            </children>
                        </VBox>

                        <VBox fx:id="chartBoxProgressoSetor" styleClass="content-card" spacing="10.0" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <children>
                                <Label styleClass="widget-title" text="Progresso Médio por Setor" />
                                <BarChart fx:id="barChartProgressoSetor" VBox.vgrow="ALWAYS"
                                          legendVisible="false">
                                    <xAxis>
                                        <CategoryAxis side="BOTTOM" label="Setor" />
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis side="LEFT" label="Progresso Médio (%)" />
                                    </yAxis>
                                </BarChart>
                            </children>
                        </VBox>

                        <VBox fx:id="chartBoxUsuariosPorSetor" styleClass="content-card" spacing="10.0" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <children>
                                <Label styleClass="widget-title" text="Usuários por Setor" />
                                <BarChart fx:id="barChartUsuariosPorSetor" legendVisible="false" VBox.vgrow="ALWAYS">
                                    <xAxis>
                                        <CategoryAxis label="Setor" side="BOTTOM" />
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis label="Nº de Usuários" side="LEFT" />
                                    </yAxis>
                                </BarChart>
                            </children>
                        </VBox>
                    </children>
                </GridPane>

                        <VBox fx:id="chartBoxAreasDeAtencao" styleClass="content-card-alert" spacing="10.0" GridPane.columnIndex="1" GridPane.rowIndex="0" GridPane.columnSpan="2" visible="false" managed="false">
                            <children>
                                <Label styleClass="widget-title-alert" text="⚠️ Áreas de Atenção (Progresso &lt; 50%)" />
                                <ListView fx:id="listAreasDeAtencao" styleClass="alert-list-view" VBox.vgrow="ALWAYS"/>
                            </children>
                        </VBox>
                    </children>
                </GridPane>

                <GridPane fx:id="chartsGrid2" hgap="25.0" vgap="25.0">
                    <columnConstraints>
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                    </columnConstraints>
                    <rowConstraints>
                        <RowConstraints minHeight="10.0" prefHeight="300.0" vgrow="SOMETIMES" />
                    </rowConstraints>
                    <children>
                        <VBox styleClass="content-card" spacing="10.0" GridPane.rowIndex="0" GridPane.columnIndex="0">
                            <children>
                                <Label styleClass="widget-title" text="Foco dos Objetivos (Hard vs Soft)" />
                                <PieChart fx:id="pieChartObjetivoTipo" VBox.vgrow="ALWAYS" legendVisible="true" />
                            </children>
                        </VBox>

                        <VBox styleClass="content-card" spacing="10.0" GridPane.rowIndex="0" GridPane.columnIndex="1">
                            <children>
                                <Label styleClass="widget-title" text="Objetivos por Status" />
                                <PieChart fx:id="pieChartObjetivoStatus" legendVisible="true" VBox.vgrow="ALWAYS" />
                            </children>
                        </VBox>

                        <VBox styleClass="content-card" spacing="10.0" GridPane.rowIndex="0" GridPane.columnIndex="2">
                            <children>
                                <Label styleClass="widget-title" text="PDIs por Status" />
                                <PieChart fx:id="pieChartPDIStatus" legendVisible="true" VBox.vgrow="ALWAYS" />
                            </children>
                        </VBox>
                    </children>
                </GridPane>

                <GridPane fx:id="bottomGrid" hgap="25.0" vgap="25.0">
                    <columnConstraints>
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" percentWidth="60.0"/>
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" percentWidth="40.0"/>
                    </columnConstraints>
                    <rowConstraints>
                        <RowConstraints minHeight="10.0" prefHeight="300.0" vgrow="SOMETIMES"/>
                    </rowConstraints>
                    <children>
                        <VBox styleClass="content-card" spacing="10.0" GridPane.columnIndex="0">
                            <children>
                                <Label styleClass="widget-title" text="Progresso Agregado por Área" />
                                <TableView fx:id="tableRanking" VBox.vgrow="ALWAYS">
                                    <columns>
                                        <TableColumn fx:id="colRankNome" prefWidth="250.0" text="Setor" />
                                        <TableColumn fx:id="colRankLiderados" prefWidth="120.0" text="Nº Colaboradores" />
                                        <TableColumn fx:id="colRankPDIs" prefWidth="100.0" text="Nº PDIs" />
                                        <TableColumn fx:id="colRankProgresso" prefWidth="150.0" text=" Metas Atingidas" />
                                    </columns>
                                    <columnResizePolicy>
                                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                    </columnResizePolicy>
                                </TableView>
                            </children>
                        </VBox>
                        <VBox styleClass="content-card-alert" spacing="10.0" GridPane.columnIndex="1">
                            <children>
                                <Label styleClass="widget-title-alert" text="⚠️ Alertas (Metas Vencidas)" />
                                <ListView fx:id="listAlertas" styleClass="alert-list-view" VBox.vgrow="ALWAYS" />
                            </children>
                        </VBox>
                    </children>
                </GridPane>
            </children>
        </VBox>
    </content>
</ScrollPane>